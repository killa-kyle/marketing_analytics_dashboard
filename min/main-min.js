gapi.analytics.ready(function(){function t(t){gapi.client.analytics.data.realtime.get({ids:t.ids,metrics:"rt:activeUsers",dimensions:"rt:pageTitle,rt:pagePath,rt:latitude,rt:longitude,rt:region,rt:country"}).then(function(t){var e=t.result.rows;ACTIVE_USERS_MAP.init(e),$(".active-pages").html("");for(var a=e.length-1;a>=0;a--)$(".active-pages").append('<a class="list-group-item" target="_blank" href="https://www.theexpertinstitute.com'+e[a][1]+'">'+e[a][0]+" - "+e[a][6]+"</a>")})}function e(t){var e=moment(),a=n({ids:t,dimensions:"ga:channelGrouping",metrics:"ga:sessions,ga:goal1ConversionRate,ga:goal1Completions",sort:"-ga:sessions","start-date":moment(e).subtract(1,"day").day(0).format("YYYY-MM-DD"),"end-date":moment(e).format("YYYY-MM-DD")}),o=n({ids:t,dimensions:"ga:channelGrouping",metrics:"ga:sessions,ga:goal1ConversionRate,ga:goal1Completions",sort:"-ga:sessions","start-date":moment(e).subtract(1,"day").day(0).subtract(1,"week").format("YYYY-MM-DD"),"end-date":moment(e).subtract(1,"day").day(6).subtract(1,"week").format("YYYY-MM-DD")}),r=n({ids:t,dimensions:"ga:channelGrouping",metrics:"ga:sessions,ga:goal1ConversionRate,ga:goal1Completions",sort:"-ga:sessions","start-date":moment(e).subtract(1,"months").startOf("month").format("YYYY-MM-DD"),"end-date":moment(e).subtract(1,"months").endOf("month").format("YYYY-MM-DD")});Promise.all([a,o,r]).then(function(t){console.log("query dates:",t[0].query["start-date"]),console.log("query dates:",t[0].query["end-date"]);var e=t[0].rows.map(function(t){return t}),a=t[1].rows.map(function(t){return t}),n=t[2].rows.map(function(t){return t});$(".this-week-date-header").html(moment(t[0].query["start-date"]).format("MM/DD/YY")+" - "+moment(t[0].query["end-date"]).format("MM/DD/YY"));var o=new Array(3);o[0]=e,o[1]=a,o[2]=n;for(var r=0,s=0,i=0,c=0;c<o[0].length;c++){var l=o[0][c][0],d=parseInt(o[0][c][1]),m=parseFloat(o[0][c][2]).toFixed(2),g=parseInt(o[0][c][3]),u=parseInt(o[1][c][1]),p=parseFloat(o[1][c][2]).toFixed(2),f=parseInt(o[1][c][3]),h=parseInt(o[2][c][1]),Y=parseFloat(o[2][c][2]).toFixed(2),v=parseInt(o[2][c][3]);r+=d,s+=u,i+=h,console.log(r),$("#channels").append('<tr class="channel-row"><td>'+l+"</td><td>"+d.toLocaleString()+"<span> ("+g+") ("+m+"%)</span></td><td>"+u.toLocaleString()+"<span> ("+f+") ("+p+"%)</span></td><td>"+h.toLocaleString()+"<span> ("+v+") ("+Y+"%)</span></td></tr>")}$("#channels").append("<tr><td><strong>TOTAL:</strong></td><td><strong>"+r.toLocaleString()+"<strong></td><td><strong>"+s.toLocaleString()+"<strong></td><td><strong>"+i.toLocaleString()+"<strong></td></tr>")})}function a(t){var e=moment(),a=n({ids:t,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":moment(e).subtract(1,"day").day(0).format("YYYY-MM-DD"),"end-date":moment(e).format("YYYY-MM-DD")}),s=n({ids:t,dimensions:"ga:date,ga:nthDay",metrics:"ga:sessions","start-date":moment(e).subtract(1,"day").day(0).subtract(1,"week").format("YYYY-MM-DD"),"end-date":moment(e).subtract(1,"day").day(6).subtract(1,"week").format("YYYY-MM-DD")});Promise.all([a,s]).then(function(t){var e=t[0].rows.map(function(t){return+t[2]}),a=t[1].rows.map(function(t){return+t[2]}),n=t[1].rows.map(function(t){return+t[0]});n=n.map(function(t){return moment(t,"YYYYMMDD").format("ddd")});var s={labels:n,datasets:[{label:"Last Week",fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",data:a},{label:"This Week",fillColor:"rgba(151,187,205,0.5)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",data:e}]};new Chart(o("chart-1-container")).Line(s),r("legend-1-container",s.datasets)})}function n(t){return new Promise(function(e,a){var n=new gapi.analytics.report.Data({query:t});n.once("success",function(t){e(t)}).once("error",function(t){a(t)}).execute()})}function o(t){var e=document.getElementById(t),a=document.createElement("canvas"),n=a.getContext("2d");return e.innerHTML="",a.width=e.offsetWidth,a.height=e.offsetHeight,e.appendChild(a),n}function r(t,e){var a=document.getElementById(t);a.innerHTML=e.map(function(t){var e=t.color||t.fillColor,a=t.label;return'<li><i style="background:'+e+'"></i>'+a+"</li>"}).join("")}gapi.analytics.auth.authorize({container:"embed-api-auth-container",clientid:"476592068856-ki5v355o2t1pthp0h73s6bgddm3v0i80.apps.googleusercontent.com"});var s=new gapi.analytics.ext.ActiveUsers({container:"active-users-container",pollingInterval:5});s.once("success",function(){var t=this.container.firstChild,e;this.on("change",function(t){var a=this.container.firstChild,n=t.delta>0?"is-increasing":"is-decreasing";a.className+=" "+n,clearTimeout(e),e=setTimeout(function(){a.className=a.className.replace(/ is-(increasing|decreasing)/g,"")},3e3)})});var i=new gapi.analytics.ext.ViewSelector2({container:"view-selector-container"}).execute();i.on("viewChange",function(a){var n=document.getElementById("view-name");n.innerHTML=a.property.name+" ("+a.view.name+")",s.set(a).execute(),e(a.ids),t(a),setInterval(function(){t(a)},15e3)}),Chart.defaults.global.animationSteps=60,Chart.defaults.global.animationEasing="easeInOutQuart",Chart.defaults.global.responsive=!0,Chart.defaults.global.maintainAspectRatio=!1});